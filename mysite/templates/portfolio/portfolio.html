{% extends "base_portfolio.html" %}
{% block body %}
<div class="lg:hero bg-base-200 min-h-full max-h-full min-w-full  relative  rounded-box p-[1rem] flex flex-col flex-1">
  {% if owner == request.user %}
  <div class="lg:absolute lg:top-5 lg:left-5 z-10">
      <button class="btn-xs btn btn-secondary" onclick="portfolio_modal.showModal(); editForm('{{ object.profile_picture.url }}', '{{ object.description }}')">
          Edit Details
      </button>
  </div>
  {% endif %}
  <div class="hero-content min-w-full justify-between lg:flex-row-reverse lg:p-0 flex-col flex-1">
    <img
      src="{{ object.profile_picture.url }}"
      class="lg:max-w-sm w-full rounded-lg shadow-2xl"
    />
    <div>
      <div class="flex flex-col lg:flex-row lg:items-center gap-2 items-start">
        <span class="text-5xl font-bold ">Hi, I am</span>
        <span class="text-5xl text-accent bg-accent-content rounded-box wrap-normal p-2">{{ object.user.first_name }}</span>
      </div>
      <p class="py-6 text-justify">
        {{ object.description }}
      </p>
      <a class="btn btn-primary" href="{% url 'service_user' object.user.username %}">View Services</a>
    </div>
  </div>
</div>

<!-- Modals -->
 <dialog id="portfolio_modal" class="modal">
  <div class="modal-box flex justify-center">
    <form method="dialog">
      <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">âœ•</button>
    </form>
    <fieldset class="fieldset bg-base-200 border-base-300 rounded-box w-xs border p-4 h-3/4">
        <legend class="fieldset-legend text-xl">Portfolio</legend>
            <form action="{% url 'portfolio_update' object.id %}" method="post" id="portfolio_form" class="flex flex-col gap-2" enctype="multipart/form-data">
                {% csrf_token %}
                {{ portfolio_form.as_p }}
                <div class="hidden" id="preview_container">
                    <p>Image Preview:</p>
                    <img src="" id="image_preview" alt="image preview">
                </div>
                <button type="submit" class="btn btn-primary mt-2">Submit</button>
            </form>
        </div>
    </fieldset>
</dialog>
{% endblock %}

{% block script %}
<script>
    function editForm(image, description){
        const image_preview = document.querySelector('#preview_container')
        const description_input = document.querySelector('#id_description')
        const image_input = document.querySelector('#id_profile_picture')
        
        image_preview.className.remove;
        image_preview.className = 'block'
        image_input.removeAttribute('required');
        image_preview.querySelector('#image_preview').src = image
        description_input.value = description
    }
</script>
{% endblock %}